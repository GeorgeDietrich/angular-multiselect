// AngularJS Multiselect
// https://github.com/namoscato/angular-multiselect
// 
// Version: 1.1.4
// License: MIT
(function(){"use strict";angular.module("amo.multiselect",["ui.bootstrap.dropdown"])})();(function(){"use strict";angular.module("multiselectDemo",["amo.multiselect"])})();(function(){"use strict";angular.module("amo.multiselect").constant("amoMultiselectConfig",{deselectAllText:"Deselect All",filterText:"Search...",isDeselectAllEnabled:true,isFilterEnabled:true,isSelectAllEnabled:true,selectAllText:"Select All",selectedSuffixSingularText:"item",selectedSuffixText:"items",selectText:"Select..."})})();(function(){"use strict";angular.module("amo.multiselect").directive("amoMultiselectDropdown",e);function e(){return{link:e,restrict:"E",templateUrl:"amo/multiselect/multiselect-dropdown.html"};function e(e,t,l){var n=e.multiselectDropdown;n.getSelectAllLabel=o;n.toggleAllSelectedState=i;n.toggleSelectedState=r;function o(){if(n.state.isSelectAllCheckboxVisible){return n.isAllSelected?n.text.deselectAll:n.text.selectAll}else if(n.state.isSelectAllEnabled){return n.text.selectAll}return n.text.deselectAll}function i(){var e;n.isAllSelected=!n.isAllSelected;if(!n.state.isSelectAllEnabled){e=false}else if(!n.state.isDeselectAllEnabled){e=true}else{e=n.isAllSelected}angular.forEach(n.optionsFiltered,function(t){angular.forEach(t,function(t){t.selected=e})});n.exposeSelectedOptions()}function r(e){e.selected=!e.selected;n.exposeSelectedOptions()}}}})();(function(){"use strict";e.$inject=["$compile","$parse","$timeout","AmoMultiselectFactory","amoMultiselectConfig","amoMultiselectFormatService","filterFilter"];angular.module("amo.multiselect").directive("amoMultiselect",e);function e(e,t,l,n,o,i,r){return{link:s,require:"ngModel",restrict:"E"};function s(s,u,c,a){var p=c.label?t(c.label):angular.noop,d=E("isDeselectAllEnabled",true),g,f=E("isSelectAllEnabled",true),m=[],b=c.onChange?t(c.onChange):angular.noop,w=c.onToggleDropdown?t(c.onToggleDropdown):angular.noop,h=[];var S=new n(c.options,s),x=s.$new(),O={};x.multiselectDropdown=O;O.groups=[];O.groupOptions={};O.optionsFiltered={};O.filter={};O.state={isDeselectAllEnabled:d,isFilterEnabled:E("isFilterEnabled",true),isSelectAllEnabled:f,isSelectAllVisible:f||d,isSelectAllCheckboxVisible:f&&d};O.text={deselectAll:E("deselectAllText"),filter:E("filterText"),selectAll:E("selectAllText")};O.exposeSelectedOptions=T;O.getSelectedCount=v;O.hasSelectedMultipleItems=y;O.isGroupVisible=$;O.isSelectAllToggleDisabled=j;O.onToggleDropdown=C;F();function D(e){m.push(S.getLabel(e))}function A(){var e,t,l;m.length=0;O.groupOptions={};O.optionsFiltered={};O.groups=S.getGroups();angular.forEach(S.getOptions(),function(n,o){angular.forEach(n,function(n,i){t=false;l=S.getValue(n);for(e=0;e<h.length;e++){if(angular.equals(h[e],l)){t=true;D(n);break}}if(angular.isUndefined(O.groupOptions[o])){O.groupOptions[o]=[]}O.groupOptions[o].push({id:i,label:S.getLabel(n),value:l,selected:t})})});V()}function T(){var e;m.length=0;h.length=0;angular.forEach(O.groupOptions,function(t,l){angular.forEach(t,function(t,n){if(!t.selected){return}e=S.getOption(n,l);D(e);h.push(S.getValue(e))})});g=true;a.$setViewValue(h);b(x,{label:V()})}function v(){return h.length}function E(e,l){if(angular.isDefined(c[e])){return l?t(c[e])(s):c[e]}return o[e]}function y(){return v()>1}function F(){u.append(e("<amo-multiselect-dropdown></amo-multiselect-dropdown>")(x));s.$on("$destroy",function(){x.$destroy()});s.$watch(S.getOptionsExpression(),function(e){S.setOptions(e);A()},true);s.$watch(function(){return a.$modelValue},function(e){if(g){g=false;return}if(angular.isArray(e)){h=e}A()},true)}function $(e){if(!S.isGrouped()){return false}return r(O.groupOptions[e],O.filter).length>0}function j(){if(!f){return h.length===0}else if(!d){return h.length===S.getOptionsCount()}return false}function C(e){if(!e){l(function(){O.filter={}})}w(x,{isOpen:e})}function V(){var e=c.selectText||o.selectText;if(m.length>0){if(angular.isDefined(m[0])){e=i.joinLabels(m)}else{e=i.pluralize(m,c.selectedSuffixText,c.selectedSuffixSingularText||c.selectedSuffixText)}}O.selectedLabel=e;if(angular.isFunction(p.assign)){p.assign(s,e)}return e}}}})();(function(){"use strict";e.$inject=["$parse"];angular.module("amo.multiselect").factory("AmoMultiselectFactory",e);function e(e){var t=/^\s*(?:([\s\S]+?)\s+as\s+)?([\s\S]+?)(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+([\$\w][\$\w]*)\s+in\s+([\s\S]+?)\s*$/;return function l(n,o){var i=this;var r;i.getGroup=s;i.getGroups=u;i.getLabel=c;i.getOption=p;i.getOptions=d;i.getOptionsCount=g;i.getOptionsExpression=f;i.getValue=m;i.isGrouped=w;i.setOptions=h;b();function s(e){if(!w()){return null}return r.groupFunction(o,a(e))}function u(e){return r.groups}function c(e){return r.labelFunction(o,a(e))}function a(e){var t={};t[r.value]=e;return t}function p(e,t){if(angular.isUndefined(t)){t=null}return r.groupOptions[t][e]}function d(){return r.groupOptions}function g(){return r.optionsCount}function f(){return r.optionsExpression}function m(e){return r.selectFunction(o,a(e))}function b(){var l=n.match(t);if(l===null){throw new Error('Expected "'+n+'" to be in form of "[_select_ as] _label_ [group by _group_] for _value_ in _array_"')}r={groupFunction:angular.isDefined(l[3])?e(l[3]):null,labelFunction:e(l[2]),optionsExpression:l[5],selectFunction:e(angular.isDefined(l[1])?l[1]:l[4]),value:l[4]}}function w(){return r.groupFunction!==null}function h(e){var t;if(!angular.isArray(e)){throw new Error('Expected "'+r.optionsExpression+'" to be Array')}r.groups=[];r.groupOptions={};r.optionsCount=e.length;e.forEach(function(e){t=s(e);if(angular.isUndefined(r.groupOptions[t])){r.groups.push(t);r.groupOptions[t]=[]}r.groupOptions[t].push(e)});return r.groupOptions}return i}}})();(function(){"use strict";e.$inject=["amoMultiselectConfig"];angular.module("amo.multiselect").service("amoMultiselectFormatService",e);function e(e){var t=this;t.joinLabels=l;t.pluralize=n;function l(e){var t,l;if(e.length===1){return e[0]}l=e.pop();t=e.join(", ");if(e.length>1){t+=","}return t+" and "+l}function n(t,l,n){var o=t.length+" ";if(t.length===1){o+=n||e.selectedSuffixSingularText}else{o+=l||e.selectedSuffixText}return o}}})();(function(){"use strict";e.$inject=["$timeout"];angular.module("multiselectDemo").controller("AppController",e);function e(e){var t=this;t.modelObject=[{id:2,label:"Two"}];t.modelObjectGrouped=[{category:"Pizza",id:2,label:"Two"}];t.modelObjectProperty=[2];t.modelStringTwo=["One","Two"];t.optionsObject=[{id:1,label:"One"},{id:2,label:"Two"},{id:3,label:"Three"}];t.optionsObjectDefer=[{id:1},{id:2},{id:3}];t.optionsObjectGrouped=[{category:"Pizza",id:1,label:"One"},{category:"Pizza",id:2,label:"Two"},{category:"Hamburger",id:3,label:"Three"}];t.optionsString=["One","Two","Three"];t.addObject=l;t.onChange=n;t.onToggleDropdown=o;function l(){t.optionsObject.push({id:t.optionsObject.length+1,label:"Option "+(t.optionsObject.length+1)})}function n(e){console.log("onChange",e)}function o(l){console.log("onToggleDropdown",l);if(l){e(function(){t.optionsObjectDefer=t.optionsObject},300)}}}})();angular.module("amo.multiselect").run(["$templateCache",function(e){e.put("amo/multiselect/multiselect-dropdown.html",'<div class="btn-group btn-group-multiselect" auto-close="outsideClick" ng-attr-title="{{ multiselectDropdown.selectedLabel }}" ng-class="{ \'state-selected-multiple\': multiselectDropdown.hasSelectedMultipleItems() }" on-toggle="multiselectDropdown.onToggleDropdown(open)" uib-dropdown> <button type="button" class="btn btn-default" uib-dropdown-toggle> <span class="text" ng-bind="multiselectDropdown.selectedLabel"></span> <span class="badge" ng-bind="multiselectDropdown.getSelectedCount()"></span> <span class="caret"></span> </button> <div uib-dropdown-menu> <input type="text" class="form-control" ng-if="::multiselectDropdown.state.isFilterEnabled" ng-model="multiselectDropdown.filter.label" placeholder="{{ ::multiselectDropdown.text.filter }}"> <ul class="dropdown-menu-list list-unstyled"> <li ng-if="::multiselectDropdown.state.isSelectAllVisible"> <a ng-class="{ \'text-muted\': multiselectDropdown.isSelectAllToggleDisabled() }" ng-click="multiselectDropdown.toggleAllSelectedState()"> <input type="checkbox" ng-if="::multiselectDropdown.state.isSelectAllCheckboxVisible" ng-model="multiselectDropdown.isAllSelected"> <span ng-bind="multiselectDropdown.getSelectAllLabel()"></span> </a> </li> <li class="divider" ng-if="::multiselectDropdown.state.isSelectAllVisible"></li> <li class="dropdown-header" ng-bind="group" ng-if="multiselectDropdown.isGroupVisible(group)" ng-repeat-start="group in multiselectDropdown.groups"> </li> <li ng-repeat="option in multiselectDropdown.optionsFiltered[group] = (multiselectDropdown.groupOptions[group] | filter : multiselectDropdown.filter)"> <a ng-attr-title="{{ option.label }}" ng-click="multiselectDropdown.toggleSelectedState(option)"> <input type="checkbox" ng-model="option.selected"> <span ng-bind="option.label"></span> </a> </li> <li ng-repeat-end></li> </ul> </div> </div>')}]);